"use strict";(self.webpackChunkflowtrade=self.webpackChunkflowtrade||[]).push([[734],{79734:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var r=a(25602),l=a(36478),s=a(96261),n=a(7658),i=a(74045),c=a(50135),o=a(62764),m=a(80465),u=a(7709),d=a(42059),p=a(84715);a(59300);const h=(0,l.Ng)(e=>({auth:e.firebase.auth,profileInfo:e.firebase.profile,updateProfileError:e.user.updateProfileError,updateProfileSuccess:e.user.updateProfileSuccess,geoPullApi:e.misc.geoPullApi,updateInProgress:e.user.updateInProgress,userLastSearch:e.user.userLastSearch,resetError:e.auth.resetError,resetSuccess:e.auth.resetSuccess,resetProgress:e.auth.resetProgress,userHasCancelled:e.user.userHasCancelled,discordInfo:e.user.discordInfo,resubscribeError:e.auth.resubscribeError,resubscribeSuccess:e.auth.resubscribeSuccess,resubscribeProgress:e.auth.resubscribeProgress}),e=>({updateProperty:t=>e((0,s.$)(t)),EditProfile:t=>e((0,n._t)(t)),passwordReset:t=>e((0,i.JR)(t)),resubscribeUser:t=>e((0,i.Xq)(t)),getGeoToken:()=>e((e,t,{getFirebase:a})=>{fetch("https://www.universal-tutorial.com/api/getaccesstoken",{method:"GET",headers:{Accept:"application/json","api-token":"E4-0_8Afpnb7ODEbymidSWTb6JxhfUMC2-Y04STUAlmNj2BWt3dPwPxi1sA-5s_mSuE","user-email":"elmehdi.elboukili@gmail.com"}}).then(e=>e.json()).then(t=>{t.auth_token&&e({type:"misc_set",geoPullApi:t.auth_token})}).catch(e=>{})}),getGeoCountry:()=>e((e,t,{getFirebase:a})=>{const r=t().misc.geoPullApi;return new Promise((e,t)=>{fetch("https://www.universal-tutorial.com/api/countries/",{method:"GET",headers:{Authorization:"Bearer "+r,Accept:"application/json"}}).then(e=>e.json()).then(t=>{e(t)}).catch(t=>{e(!1)})})}),getGeoState:t=>e((e=>(t,a,{getFirebase:r})=>{const l=a().misc.geoPullApi;return new Promise((t,a)=>{fetch("https://www.universal-tutorial.com/api/states/"+e,{method:"GET",headers:{Authorization:"Bearer "+l,Accept:"application/json"}}).then(e=>e.json()).then(e=>{t(e)}).catch(e=>{t(!1)})})})(t)),getGeoCity:t=>e((e=>(t,a,{getFirebase:r})=>{const l=a().misc.geoPullApi;return new Promise((t,a)=>{fetch("https://www.universal-tutorial.com/api/cities/"+e,{method:"GET",headers:{Authorization:"Bearer "+l,Accept:"application/json"}}).then(e=>e.json()).then(e=>{t(e)}).catch(e=>{t(!1)})})})(t))}))(e=>{const{auth:t,updateProfileError:a,updateProfileSuccess:l,profileInfo:s,updateInProgress:n,userLastSearch:i,resetError:h,resetSuccess:g,resetProgress:y,userHasCancelled:E,discordInfo:f,resubscribeError:b,resubscribeSuccess:v,resubscribeProgress:C,geoPullApi:N,updateProperty:w,EditProfile:S,passwordReset:F,resubscribeUser:P,getGeoToken:_,getGeoCountry:x,getGeoState:k,getGeoCity:z}=e,[U,A]=(0,r.useState)([]),[W,q]=(0,r.useState)("top-center"),[J,j]=(0,r.useState)(!0),[B,L]=(0,r.useState)(5e3),[R,O]=(0,r.useState)(!0),[G,I]=(0,r.useState)(!0),[M,V]=(0,r.useState)("bg-danger"),[T,H]=(0,r.useState)("-1"),[K,D]=(0,r.useState)("-1"),[Q,Y]=(0,r.useState)("-1"),[$,X]=(0,r.useState)(!1),Z=(0,r.useRef)(!1),ee=(0,r.useRef)(!1),te=(0,r.useRef)(!1),ae=(0,r.useRef)(!1),[re,le]=(0,r.useState)(!1),[se,ne]=(0,r.useState)(!1),[ie,ce]=(0,r.useState)(!1),[oe,me]=(0,r.useState)(!0);(0,r.useEffect)(async()=>{if(null==N)_();else{Z.current=!0;const e=new Promise(async(e,t)=>{if(0==ee.current)if("object"==typeof s.country&&null!==s.country){const t=await x();!1!==t&&t.length>0&&t.some((e,t)=>e.country_short_name.toLowerCase()==s.country.value.toLowerCase())?(ee.current=t,H(s.country.value.toLowerCase()),e(s.country.label||s.country.value)):(H(s.country.label||s.country.value),e(s.country.label||s.country.value))}else H(s.country),e(s.country);else e(!1)}),t=await e,a=new Promise(async(e,a)=>{if(0==te.current)if("object"==typeof s.state&&null!==s.state&&!1!==t){const a=await k(t);!1!==a&&a.length>0&&a.some((e,t)=>e.state_name==s.state.value)?(te.current=a,D(s.state.value)):(D(s.state.label||s.state.value),e(s.state.label||s.state.value))}else D(s.state),e(s.state);else e(!1)}),r=await a,l=new Promise(async(e,t)=>{if(0==ae.current)if("object"==typeof s.city&&null!==s.city&&!1!==r){const t=await z(r);!1!==t&&t.length>0&&t.some((e,t)=>e.city_name==s.city.value)?(ae.current=t,Y(s.city.value)):(Y(s.city.label||s.city.value),e(s.city.label||s.city.value))}else Y(s.city),e(s.city);else e(!1)});await l}},[N]),(0,r.useEffect)(()=>{void 0!==s.discordCodeRevoke?ce(!0):ce(!1),void 0!==s.discordError&&(V("bg-danger"),ue("Discord Error",discordError),S({discordError:null}),ne(!1),ce(!1))},[s]),(0,r.useEffect)(()=>{if(""!==i){ne(!0);let e=u.parse(i,!0);"code"in e&&""!=e.code?S({discordCode:e.code}):ne(!1),w({userLastSearch:""})}!1!==f?ne(!1):ce(!1)},[i,f]),(0,r.useEffect)(()=>{null!==h&&(V("bg-danger"),ue("Password Reset Failed",h)),!1!==g&&(V("bg-success"),ue("Password Reset","Please check your email for password reset instructions"))},[h,g]),(0,r.useEffect)(()=>{null!==a&&(V("bg-danger"),ue("Error",a)),!1!==l&&(V("bg-success"),ue("Profile Update","Your profile information has been updated !"))},[a,l]),(0,r.useEffect)(()=>{null!==b&&(V("bg-danger"),ue("Error",b)),!1!==v&&window.location.assign(v)},[b,v]);const ue=(e,t)=>{A([...U,{position:W,autohide:J&&B,closeButton:R,fade:G,type:M,title:e,body:t}])},de=U.reduce((e,t)=>(e[t.position]=e[t.position]||[],e[t.position].push(t),e),{}),pe={firstName:void 0!==s.firstName?s.firstName:"",lastName:void 0!==s.lastName?s.lastName:"",userOrganization:void 0!==s.organization?s.organization:"",phoneNumber:void 0!==s.phoneNumber?s.phoneNumber:"",selectedCountry:T,selectedState:K,selectedCity:Q,zipCode:void 0!==s.zip?s.zip:"",address:void 0!==s.address?s.address:""};return r.createElement(r.Fragment,null,r.createElement(c.W6,null,r.createElement(c.sK,null,r.createElement(c.UF,{sm:"12",md:"8",lg:"8",xl:"8"},r.createElement(d.l1,{initialValues:pe,validate:(he=function(e){return p.object().shape({firstName:p.string().min(2,"First name has to be at least 2 characters").required("First name is required"),lastName:p.string().min(1,"Last name has to be at least 1 character").required("Last name is required"),phoneNumber:p.string().phone().required("Phone Number is required")})},async e=>{const t=he();let a={};return await t.validate(e,{abortEarly:!1}).then(()=>{}).catch(e=>{a=e.inner.reduce((e,t)=>({...e,[t.path]:t.errors[0]}),{})}),a}),onSubmit:(e,{setSubmitting:t,setErrors:a})=>{let r,l,s,n={address:e.address,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,organization:e.userOrganization,zip:e.zipCode};if(!1!==ee.current){let e=ee.current.find(e=>e.country_short_name.toLowerCase()==T);r=void 0!==e?{label:e.country_name||"",value:e.country_short_name||""}:T}else r=T;if(!1!==te.current){let e=te.current.find(e=>e.city_name==K);l=void 0!==e?{label:e.state_name||"",value:e.state_name||""}:K}else l=K;if(!1!==ae.current){let e=ae.current.find(e=>e.city_name==Q);s=void 0!==e?{label:e.city_name||"",value:e.city_name||""}:Q}else s=Q;n={...n,country:r,city:s,state:l},S(n)}},({values:e,errors:t,touched:a,status:l,dirty:i,handleChange:o,handleBlur:m,handleSubmit:u,isSubmitting:d,isValid:p,handleReset:h,setTouched:g})=>r.createElement(c.qI,{onSubmit:u,noValidate:!0,name:"simpleForm"},r.createElement(c.sK,null,r.createElement(c.UF,{sm:"12",md:"12",lg:"12",xl:"12"},r.createElement(c.E$,null,r.createElement(c.V0,null,r.createElement("h4",{className:"card-title mb-0"},"Account Information")),r.createElement(c.W6,null,r.createElement(c.sK,null,r.createElement(c.UF,{sm:"12",md:"12",lg:"12",xl:"12"},r.createElement("div",{className:"mb-3 d-flex flex-direction-row justify-content-between"},r.createElement("div",{className:"d-flex align-items-center"},r.createElement("div",{className:"c-avatar mr-3",style:{width:45,height:45}},r.createElement(c.Jm,{src:"https://flowtrade.com/images/avatarplaceholder.png",className:"c-avatar-img"})),r.createElement("h3",{className:""},s.email))))),r.createElement(c.sK,null,r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"firstName"},"First Name"),r.createElement(c.ev,{type:"text",name:"firstName",id:"firstName",autoComplete:"given-name",valid:a.firstName&&!t.firstName,invalid:a.firstName&&!!t.firstName,required:!0,onChange:o,onBlur:m,value:e.firstName}),r.createElement(c.WJ,null,t.firstName))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"lastName"},"Last Name"),r.createElement(c.ev,{type:"text",name:"lastName",id:"lastName",autoComplete:"family-name",valid:a.lastName&&!t.lastName,invalid:a.lastName&&!!t.lastName,required:!0,onChange:o,onBlur:m,value:e.lastName}),r.createElement(c.WJ,null,t.lastName))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"userOrganization"},"Organization"),r.createElement(c.ev,{type:"text",name:"userOrganization",id:"userOrganization",autoComplete:"userOrganization",valid:a.userOrganization&&!t.userOrganization,invalid:a.userOrganization&&!!t.userOrganization,required:!0,onChange:o,onBlur:m,value:e.userOrganization}),r.createElement(c.WJ,null,t.userOrganization))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"phoneNumber"},"Phone Number"),r.createElement(c.ev,{type:"text",name:"phoneNumber",id:"phoneNumber",autoComplete:"phone-number",valid:a.phoneNumber&&!t.phoneNumber,invalid:a.phoneNumber&&!!t.phoneNumber,required:!0,onChange:o,onBlur:m,value:e.phoneNumber}),r.createElement(c.WJ,null,t.phoneNumber))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"selectedCountry"},"Country"),Z.current&&ee.current&&r.createElement(c.mt,{onChange:e=>{gotCountry(e),H(e.target.value),setFieldValue("selectedCountry",e.target.value)},valid:a.selectedCountry&&!t.selectedCountry,invalid:a.selectedCountry&&!!t.selectedCountry,name:"selectedCountry",id:"selectedCountry",value:T,custom:!0,required:!0},r.createElement("option",{key:"-1",value:"-1",disabled:!0},"Country"),ee.current.map((e,t)=>r.createElement("option",{key:t,value:e.country_short_name.toLowerCase()},e.country_name)))||r.createElement(c.ev,{type:"text",name:"selectedCountry",id:"selectedCountry",placeholder:"Country",valid:a.selectedCountry&&!t.selectedCountry,invalid:a.selectedCountry&&!!t.selectedCountry,required:!0,onChange:e=>{H(e.target.value),o(e)},onBlur:m,value:"-1"==T?"":T}),r.createElement(c.WJ,null,t.selectedCountry))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"selectedState"},"State"),Z.current&&te.current&&r.createElement(c.mt,{onChange:e=>{gotState(e),D(e.target.value),setFieldValue("selectedState",e.target.value)},valid:a.selectedState&&!t.selectedState,invalid:a.selectedState&&!!t.selectedState,name:"selectedState",id:"selectedState",value:K,custom:!0,required:!0},r.createElement("option",{key:"-1",value:"-1",disabled:!0},"State"),te.current.map((e,t)=>r.createElement("option",{key:t,value:e.state_name},e.state_name)))||r.createElement(c.ev,{type:"text",name:"selectedState",id:"selectedState",placeholder:"State",valid:a.selectedState&&!t.selectedState,invalid:a.selectedState&&!!t.selectedState,required:!0,onChange:e=>{D(e.target.value),o(e)},onBlur:m,value:"-1"==K?"":K}),r.createElement(c.WJ,null,t.selectedState))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"selectedCity"},"City"),Z.current&&ae.current&&r.createElement(c.mt,{onChange:e=>{Y(e.target.value),setFieldValue("selectedCity",e.target.value)},valid:a.selectedCity&&!t.selectedCity,invalid:a.selectedCity&&!!t.selectedCity,name:"selectedCity",id:"selectedCity",value:Q,custom:!0,required:!0},r.createElement("option",{key:"-1",value:"-1",disabled:!0},"City"),ae.current.map((e,t)=>r.createElement("option",{key:t,value:e.city_name},e.city_name)))||r.createElement(c.ev,{type:"text",name:"selectedCity",id:"selectedCity",placeholder:"City",valid:a.selectedCity&&!t.selectedCity,invalid:a.selectedCity&&!!t.selectedCity,required:!0,onChange:e=>{Y(e.target.value),o(e)},onBlur:m,value:"-1"==Q?"":Q}),r.createElement(c.WJ,null,t.selectedCity))),r.createElement(c.UF,{sm:"12",md:"6",lg:"6",xl:"6"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"zipCode"},"ZIP Code"),r.createElement(c.ev,{type:"text",name:"zipCode",id:"zipCode",placeholder:"ZIP Code",valid:a.zipCode&&!t.zipCode,invalid:a.zipCode&&!!t.zipCode,required:!0,onChange:o,onBlur:m,value:e.zipCode}),r.createElement(c.WJ,null,t.zipCode))),r.createElement(c.UF,{sm:"12",md:"12",lg:"12",xl:"12"},r.createElement(c.fW,null,r.createElement(c.MJ,{htmlFor:"address"},"Address"),r.createElement(c.ev,{type:"text",name:"address",id:"address",placeholder:"Address",valid:a.address&&!t.address,invalid:a.address&&!!t.address,required:!0,onChange:o,onBlur:m,value:e.address}),r.createElement(c.WJ,null,t.address)))),r.createElement("div",{className:"mr-1 mt-3 text-center"},r.createElement(c.Q_,{style:{width:"30%"},type:"submit",color:"primary",className:"btn btn-primary btn-pill font-weight-bold",disabled:!p||n},n?"Updating ...":"Update"))))))))),r.createElement(c.UF,{sm:"12",md:"4",lg:"4",xl:"4"},r.createElement(c.sK,null,r.createElement(c.UF,{sm:"12",md:"12",lg:"12",xl:"12"},r.createElement(c.E$,null,r.createElement(c.V0,null,r.createElement("h4",{className:"card-title mb-0"},"Account Actions")),r.createElement(c.W6,null,r.createElement(c.XR,{flush:!0},r.createElement(c.y5,{className:"d-flex justify-content-between align-items-center"},r.createElement("div",{className:"d-flex align-items-center"},r.createElement(o.Ay,{size:"lg",name:"cil-lock-locked",className:"mr-1"})," Password"),r.createElement(c.Q_,{onClick:()=>{let e=r.firebase.firebase.auth().currentUser;void 0!==e&&"email"in e&&F(e.email)},className:"font-weight-bold",shape:"pill",color:"primary",disabled:y},y?"Change my password ...":"Change my password")),r.createElement(c.y5,{className:"d-flex justify-content-between align-items-center"},r.createElement("div",{className:"d-flex align-items-center"},r.createElement(o.Ay,{size:"lg",name:"cil-document",className:"mr-1"})," ",E?"Billing":"Billing / Subscription"),r.createElement(c.Q_,{className:"font-weight-bold",shape:"pill",color:"primary",onClick:async()=>{le(!0);try{const e=r.firebase.firebase.app().functions("us-central1").httpsCallable("ext-firestore-stripe-payments-createPortalLink"),{data:t}=await e({returnUrl:window.location.origin});window.location.assign(t.url)}catch(e){alert("something went wrong"),le(!1)}},disabled:re},re?"Loading...":E?"Update billing":"Update billing | Cancel subscription")),E&&r.createElement(c.y5,{className:"d-flex justify-content-between align-items-center"},r.createElement("div",{className:"d-flex align-items-center"},r.createElement(o.Ay,{size:"lg",name:"cil-update",className:"mr-1"})," ReSubscribe"),r.createElement("div",{className:"d-flex justify-content-center align-items-center"},r.createElement("span",{className:"font-weight-bold mr-1"},"Yearly"),r.createElement(c.Cd,{key:"planMode",color:"primary",checked:oe,value:"primary",variant:"3d",shape:"pill",onChange:()=>me(!oe)}),r.createElement("span",{className:"font-weight-bold ml-1"},"Monthly"),r.createElement(c.Q_,{className:"font-weight-bold ml-3",shape:"pill",color:"primary",onClick:()=>{const e={line_items:[{price:oe?"price_1KTqRLD48AfiHVvU6GSQOFCD":"price_1HWBeeD48AfiHVvUKs7scuuN",quantity:1}],success_url:"http://localhost:8080",cancel_url:"http://localhost:8080",metadata:{userUid:t.uid},subscription_data:[{metadata:{renewSubscription:!0,renewPeriod:oe?"Monthly":"Yearly",newCheckout:!0,userUid:t.uid,email:s.email,first_name:s.firstName||"",last_name:s.lastName||"",incoming_request:"Resubscribed From Platform"}}]};P(e)},disabled:C},C?"Loading...":"ReSubscribe")))))))),r.createElement(c.sK,null,r.createElement(c.UF,{sm:"12",md:"12",lg:"12",xl:"12"},r.createElement(c.E$,null,r.createElement(c.V0,null,r.createElement("h4",{className:"card-title mb-0"},"Account Integrations")),r.createElement(c.W6,null,r.createElement(c.XR,{flush:!0},!f&&r.createElement(c.y5,{className:"d-flex justify-content-between align-items-center"},r.createElement("div",{className:"d-flex align-items-center"},r.createElement(o.Ay,{size:"lg",name:"cib-discord",className:"mr-1"})," Discord"),r.createElement(c.Q_,{href:"https://discord.com/api/oauth2/authorize?client_id=973592883699519558&redirect_uri=https%3A%2F%2Fapp.flowtrade.com%2Faccount%2Fprofile&response_type=code&scope=identify%20email",className:"font-weight-bold text-white",shape:"pill",style:{backgroundColor:"#5865F2"},disabled:se},se?"Linking your discord ...":"Link discord account")),f&&r.createElement(c.y5,{className:"d-flex justify-content-between align-items-center"},r.createElement("div",{className:"d-flex align-items-center"},r.createElement(o.Ay,{size:"lg",name:"cib-discord",className:"mr-1"})," Discord"),r.createElement(c.Q_,{onClick:()=>{ce(!0),S({discordCodeRevoke:!0})},disabled:ie,className:"font-weight-bold text-white",shape:"pill",style:{backgroundColor:"#5865F2"}},r.createElement("div",{className:"d-flex align-items-center"},r.createElement("div",{className:"c-avatar mr-3",style:{width:25,height:25}},r.createElement(c.Jm,{src:"https://cdn.discordapp.com/avatars/"+f.id+"/"+f.avatar+".png",className:"c-avatar-img"})),r.createElement("div",{className:""},ie?"Unlinking ... ":"Unlink "," ",r.createElement("span",{className:"font-weight-light font-italic"},f.username+"#"+f.discriminator))))))))))),r.createElement(c.UF,{sm:"12",lg:"12"},Object.keys(de).map(e=>r.createElement(c.Yq,{position:e,key:"toaster"+e},de[e].map((e,t)=>r.createElement(c.JY,{className:M,key:"toast"+t,show:!0,autohide:e.autohide,fade:e.fade},r.createElement(c.AH,{className:M,closeButton:e.closeButton},e.title),r.createElement(c.Bw,null,e.body)))))))),r.createElement(m.$H,{license:"11797593"}));var he})}}]);