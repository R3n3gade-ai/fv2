"use strict";(self.webpackChunkflowtrade=self.webpackChunkflowtrade||[]).push([[548],{94548:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var l=r(25602),a=r(36478),o=(r(91974),r(96261)),c=r(46770),s=r(73419),n=r(50135),u=(r(62764),r(60711)),i=r.n(u),m=r(42111);r(17665);const d=e=>{const t=["","k","M","G","T","P","E"];var r=Math.log10(Math.abs(e))/3|0;if(0==r)return e;if(void 0===t[r]||r>=3)return!1;var l=t[r];return(e/Math.pow(10,3*r)).toFixed(1)+l},f=(e,t)=>e.epoch>t.epoch?-1:e.epoch<t.epoch?1:0;let b=null;const p=(0,a.Ng)(e=>({blockListData:e.charts.blockListData}),e=>({updateProperty:t=>e((0,o.$)(t))}))(e=>{const{blockListData:t,updateProperty:r}=e,[a,o]=(0,l.useState)([]),[u,p]=(0,l.useState)(100),[y,h]=(0,l.useState)("combo"),[k,S]=(0,l.useState)(!1),[v,E]=(0,l.useState)(!1);let _=(0,l.useRef)(null),w=(0,l.useRef)(null),N=(0,l.useRef)([]),g=(0,l.useRef)([]),D=(0,l.useRef)([]),z=(0,l.useRef)(null),M=((0,l.useRef)(!1),(0,l.useRef)([])),P=(0,l.useRef)([]);(0,l.useRef)(50),(0,l.useEffect)(()=>{if(null==w.current&&(w.current=l.firebase.firebase.database(l.firebase.blocks).ref("/latest").orderByChild("t").limitToLast(100)),a.length>0){g.current.map(e=>{e.ref.off("child_added")}),N.current=a;let e=[];a.map(t=>{e.push({symbol:t.value,ref:l.firebase.firebase.database(l.firebase.blocks).ref(`latestSymbols/${t.value}`).orderByChild("t").limitToLast(100)})}),g.current=e}else N.current=[],g.current=[];r({blockListData:[]}),P.current=[],M.current=[],R(),_.current&&(b=new s.A(".block-trades_table"))},[a,y,u]),(0,l.useEffect)(()=>()=>{w.current.off("child_added"),g.current.map(e=>{e.ref.off("child_added")})},[]);const R=()=>{g.current.length>0?g.current.map(e=>{e.ref.once("value",t=>{L(t,!0,e.symbol,e.ref)})}):w.current.once("value",L)},L=(e,t=!1,l=null,a=null)=>{let o=t?P.current:[],c=t?M.current:[];e.forEach(function(e){const t=e.val(),r=i()(+t.t).tz("America/New_York").format("HH:mm MMMM DD, YYYY"),l=d(Number(t.S)*Number(t.P));if(c.push({symbol:t.Sy,epoch:t.t,key:e.key}),l){if("combo"!==y){if("dark"==y&&!t.D)return;if("regular"==y&&t.D)return}if(Number(t.S)<1e3*Number(u))return;o.push({symbol:t.Sy,dark_pool:t.D,size:d(Number(t.S)),price:Number(t.P).toFixed(2),value:l,time:r,epoch:+t.t,_classes:t.D?"dark-pool_row":"",key:e.key})}}),o=Array.from(new Set(o.map(JSON.stringify))).map(JSON.parse),c=Array.from(new Set(c.map(JSON.stringify))).map(JSON.parse);const s=o.sort(f),n=c.sort(f);r({blockListData:s}),null==l?(z.current=n.slice(-1)[0].epoch,w.current.off("child_added"),w.current.on("child_added",Y)):(D.current[l]=n.slice(-1)[0].epoch,a.off("child_added"),a.on("child_added",Y)),M.current=n,P.current=s,S(!0),E(!1)},Y=e=>{if(M.current.some(t=>t.key==e.key))return;const t=e.val(),l=i()(+t.t).tz("America/New_York").format("HH:mm MMMM DD, YYYY"),a=d(Number(t.S)*Number(t.P));if(a){let e=P.current;if("combo"!==y){if("dark"==y&&!t.D)return;if("regular"==y&&t.D)return}if(Number(t.S)<1e3*Number(u))return;e.push({symbol:t.Sy,dark_pool:t.D,size:d(Number(t.S)),price:Number(t.P).toFixed(2),value:a,time:l,epoch:+t.t,_classes:t.D?"dark-pool_row":""}),r({blockListData:e.sort(f)}),P.current=e.sort(f)}},C=e=>{switch(e){case"size":return"warning";case"price":return"success";case"value":return"danger";default:return"primary"}};return l.createElement(n.W6,{innerRef:_,className:"block-trades_table"},l.createElement(n.wQ,{items:t,fields:[{key:"symbol",label:"Symbol",_style:{width:"20%"}},{key:"dark_pool",label:"Dark Pool",_style:{width:"15%"}},{key:"size",label:"Size",_style:{width:"20%"}},{key:"price",label:"Price",_style:{width:"10%"}},{key:"value",label:"Value",_style:{width:"10%"}},{key:"time",label:"Time",_style:{width:"25%"}}],columnFilter:!0,striped:!0,hover:!0,sorter:!0,scopedSlots:{symbol:(e,t)=>l.createElement("td",{style:{fontWeight:"bolder"}},e.symbol),dark_pool:(e,t)=>l.createElement("td",null,e.dark_pool&&l.createElement(n.$X,{color:"info"},"YES")),size:(e,t)=>l.createElement("td",null,l.createElement(n.$X,{style:{color:"#322201",fontSize:12},color:C("size")},e.size)),price:(e,t)=>l.createElement("td",null,l.createElement(n.$X,{style:{color:"#122b1b",fontSize:12},color:C("price")},e.price)),value:(e,t)=>l.createElement("td",null,l.createElement(n.$X,{style:{color:"#330f0f",fontSize:12},color:C("value")},e.value)),time:(e,t)=>l.createElement("td",{style:{fontWeight:"bolder"}},e.time)},columnFilterSlot:{symbol:l.createElement(c.A,{placeholderProps:"Symbols filter",onChangeProps:o,isMultiProps:!0}),dark_pool:l.createElement(n.mt,{style:{fontWeight:"bold",color:"hsl(0, 0%, 50%)"},custom:!0,size:"sm",name:"selectSm",id:"SelectLm",defaultValue:y,onChange:e=>{h(e.target.value)}},l.createElement("option",{value:"combo"},"Combo"),l.createElement("option",{value:"regular"},"Regular"),l.createElement("option",{value:"dark"},"Dark")),size:l.createElement("div",{className:"size-slider pl-3 pr-3"},l.createElement(m.A,{min:0,max:1e3,value:u,step:500,labels:{100:"+100K",500:"+500K",1e3:"+1M"},onChange:p,tooltip:!1})),price:l.createElement("div",null),value:l.createElement("div",null),time:l.createElement("div",null)}}),l.createElement("div",{className:"d-flex justify-content-center"},k&&l.createElement(n.Q_,{onClick:()=>{E(!0),g.current.length>0?g.current.map(e=>{e.ref.endBefore(D.current[e.symbol]).once("value",t=>{L(t,!0,e.symbol,e.ref)})}):w.current.endBefore(z.current).once("value",e=>{L(e,!0)})},className:"font-weight-bold",style:{width:"35%"},shape:"pill",color:"primary",disabled:v},v?"Loading ...":"Load More")))})}}]);