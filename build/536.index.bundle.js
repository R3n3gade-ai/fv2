"use strict";(self.webpackChunkflowtrade=self.webpackChunkflowtrade||[]).push([[536],{4536:(e,t,l)=>{l.r(t),l.d(t,{default:()=>h});var a=l(25602),n=l(72615),r=l(36478),m=l(60711),c=l.n(m),s=l(91974),i=l(13368),o=l.n(i),u=l(62764),d=l(50135),E=l(64079),p=l(73419);const f=function(){return a.createElement("div",{className:"no-events"},"No events found")};let v=null;const h=(0,n.Zz)((0,r.Ng)(e=>({auth:e.firebase.auth}),e=>({})),(0,s.firebaseConnect)(e=>[]))(e=>{const{auth:t}=e,[l,n]=(0,a.useState)({}),[r,m]=(0,a.useState)({}),[s,i]=(0,a.useState)([]),[h,y]=(0,a.useState)(new Date),[b,g]=(0,a.useState)([]),[k,w]=(0,a.useState)([]),[S,N]=(0,a.useState)([]),[x,A]=(0,a.useState)(!1),[C,_]=(0,a.useState)(!1),[$,H]=(0,a.useState)(!1),[D,j]=(0,a.useState)(""),[V,L]=(0,a.useState)(null),[O,T]=(0,a.useState)("");let W=(0,a.useRef)(null);const I=a.firebase.firebase.database(a.firebase.calendar).ref(`userNotes/${t.uid}`);(0,a.useEffect)(()=>{X()},[h]),(0,a.useEffect)(()=>I.on("value",e=>{e&&n(e.val()||{})}),[]),(0,a.useEffect)(()=>{let e=Object.assign({},l);Object.keys(e).forEach(t=>{e[t].date!==F(h)&&delete e[t]}),m(e)},[l,h]),(0,a.useEffect)(()=>{const e=Object.values(l).map(e=>e.date);i([...new Set(e)])},[l]),(0,a.useEffect)(()=>{W.current&&(v=new p.A(".calendar-wrapper_ref"))},[l,h]);const F=e=>e.toISOString().substring(0,10),Q=e=>Object.values(e||{}).sort((e,t)=>{const l=c()(e.time,"HH:mm:ss").unix(),a=c()(t.time,"HH:mm:ss").unix();return l>a?1:a>l?-1:0}),U=(e,t)=>a.firebase.firebase.database(a.firebase.calendar).ref(e).orderByChild("date").equalTo(F(t)).limitToLast(1e3),X=()=>{A(!0),_(!0),H(!0),U("economics",h).once("value",e=>{A(!1),g(Q(e.val()).filter(e=>"USA"===e.country))}),U("fda",h).once("value",e=>{_(!1),w(Q(e.val()))}),U("earnings",h).once("value",e=>{H(!1),N(Q(e.val()))})},q=e=>{e.preventDefault(),L(null),T("")};return a.createElement(d.W6,{innerRef:W,className:"calendar-wrapper_ref"},a.createElement(d.sK,null,a.createElement(d.UF,{md:"12",lg:"6",xl:"4"},a.createElement(d.E$,null,a.createElement(d.W6,null,a.createElement(E.Ay,{calendarType:"US",onChange:y,value:h,tileContent:({activeStartDate:e,date:t,view:l})=>a.createElement(a.Fragment,null,s.includes(F(t))&&a.createElement("div",{className:"calendar-note-indicator"}))}))),a.createElement(d.E$,null,a.createElement(d.V0,null,"Notes for ",c()(h).format("LL")),a.createElement(d.W6,null,Object.keys(r).map(e=>{const t=r[e];return a.createElement(d.E$,{key:e,color:"",className:"mb-3 border"},V===e&&a.createElement(d._c,{rows:"6",onChange:e=>T(e.target.value),value:O}),V!==e&&a.createElement(d.W6,{className:"whitespace-pre-wrap"},t.text),a.createElement(d.XW,{className:"d-flex small justify-content-between"},a.createElement("div",{className:"text-muted"},c().unix(t.timestamp).format("LL h:mm A")),V===e&&a.createElement("div",null,a.createElement("a",{onClick:t=>((e,t)=>{if(e.preventDefault(),""===O.trim())return;const a=Object.assign({},l[t],{text:O,timestamp:c()().unix()});I.child(t).update(a),L(null),T("")})(t,e),href:"#"},a.createElement(u.Ay,{name:"cil-check"})),a.createElement("a",{onClick:q,href:"#",className:"ml-3"},a.createElement(u.Ay,{name:"cil-x"}))),V!==e&&a.createElement("div",null,a.createElement("a",{onClick:t=>((e,t)=>{e.preventDefault(),L(t),T(l[t].text)})(t,e),href:"#"},a.createElement(u.Ay,{name:"cil-pencil"})),a.createElement("a",{onClick:t=>((e,t)=>{e.preventDefault(),confirm("Are you sure you want to remove this note?")&&I.child(t).remove()})(t,e),href:"#",className:"ml-3"},a.createElement(u.Ay,{name:"cil-trash"})))))}),a.createElement(d.qI,{onSubmit:e=>{if(e.preventDefault(),""===D.trim())return;const t={text:D,date:F(h),timestamp:c()().unix()};j(""),I.push(t)}},a.createElement(d._c,{placeholder:"Add a new note...",rows:"6",onChange:e=>j(e.target.value),value:D}),a.createElement("div",{className:"text-right"},a.createElement(d.Q_,{className:"mt-3",color:"secondary",type:"submit"},"Add Note")))))),a.createElement(d.UF,{md:"12",lg:"6",xl:"8"},a.createElement(d.E$,null,a.createElement(d.V0,null,a.createElement("strong",null,c()(h).format("LL"))),a.createElement(d.W6,null,a.createElement(d.E$,null,a.createElement(d.V0,null,"Earnings Events",a.createElement(d.$X,{className:o()({"ml-2":!0,"opacity-50":$}),color:S.length>1?"primary":"light",shape:"pill"},S.length)),a.createElement("div",{className:o()({"calendar-event-table-wrapper":!0,"opacity-50":$})},a.createElement(d.wQ,{header:S.length>0,items:S,fields:[{key:"time",label:"Time"},{key:"ticker",label:"Ticker"},{key:"name",label:"Name"},{key:"period",label:"Period"}],striped:!0,border:!0,hover:!1,noItemsViewSlot:a.createElement(f,null),sorter:!0,scopedSlots:{time:e=>a.createElement("td",null,c()(e.time,"HH:mm:ss").format("h:mm A")),ticker:e=>a.createElement("td",null,a.createElement("strong",null,e.ticker)),name:e=>a.createElement("td",null,e.name),period:e=>a.createElement("td",null,e.period," ",e.period_year)}}))),a.createElement(d.E$,null,a.createElement(d.V0,null,"Economic Events",a.createElement(d.$X,{className:o()({"ml-2":!0,"opacity-50":$}),color:b.length>1?"primary":"light",shape:"pill"},b.length)),a.createElement("div",{className:o()({"calendar-event-table-wrapper":!0,"opacity-50":x})},a.createElement(d.wQ,{header:b.length>0,items:b,fields:[{key:"time",label:"Time"},{key:"name",label:"Name"},{key:"period",label:"Period"}],hover:!0,border:!0,striped:!0,noItemsViewSlot:a.createElement(f,null),sorter:!0,scopedSlots:{time:e=>a.createElement("td",null,c()(e.time,"HH:mm:ss").format("h:mm A")),name:e=>a.createElement("td",null,e.event_name),period:e=>a.createElement("td",null,e.event_period," ",e.period_year)}}))),a.createElement(d.E$,null,a.createElement(d.V0,null,"FDA Events",a.createElement(d.$X,{className:o()({"ml-2":!0,"opacity-50":$}),color:k.length>1?"primary":"light",shape:"pill"},k.length)),a.createElement("div",{className:o()({"calendar-event-table-wrapper":!0,"opacity-50":C})},a.createElement(d.wQ,{header:k.length>0,items:k,fields:[{key:"time",label:"Time"},{key:"company",label:"Company"},{key:"drug",label:"Drug"},{key:"event_type",label:"Event"}],striped:!0,border:!0,noItemsViewSlot:a.createElement(f,null),hover:!1,sorter:!0,scopedSlots:{time:e=>a.createElement("td",null,c()(e.time,"HH:mm:ss").format("h:mm A")),company:e=>a.createElement("td",null,e.companies.map(e=>e.name).join(", ")),drug:e=>a.createElement("td",null,e.drug.name),event_type:e=>a.createElement("td",null,e.event_type)}}))))))))})}}]);